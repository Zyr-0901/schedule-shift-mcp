# 测试场景说明

## 数据说明

### 课程数据
- **数学提高班**（李老师）：
  - 张三（COURSE_001）
  - 王五（COURSE_003）

- **英语口语班**（王老师）：
  - 李四（COURSE_002）
  - 赵六（COURSE_004）

- **物理实验班**（张老师）：
  - 孙七（COURSE_005）

### 档期数据（按日期和课程）

#### 数学提高班（2025-01-10 至 2025-01-15）
- **2025-01-10 19:00**：满员（5/5）❌
- **2025-01-11 19:00**：有空位（2/5）✅
- **2025-01-12 19:30**：有空位（1/4）✅
- **2025-01-13 19:00**：完全空（0/5）✅
- **2025-01-14 19:00**：有空位（3/5）✅
- **2025-01-15 19:00**：满员（5/5）❌

#### 英语口语班（2025-01-10 至 2025-01-15）
- **2025-01-10 19:00**：有空位（4/6）✅
- **2025-01-11 19:00**：满员（6/6）❌
- **2025-01-12 19:00**：有空位（2/6）✅
- **2025-01-13 19:00**：满员（6/6）❌
- **2025-01-14 19:00**：有空位（3/6）✅
- **2025-01-15 19:00**：有空位（1/6）✅

#### 物理实验班
- **2025-01-16 14:00**：有空位（2/8）✅
- **2025-01-17 14:00**：满员（8/8）❌

---

## 1. 可以测试可约档期的场景

### ✅ 场景 1：目标日期有空位（直接可约）
**测试条件**：
```json
{
  "course_name": "数学提高班",
  "original_date": "2025-01-10",
  "target_date": "2025-01-11"
}
```
**预期结果**：
- `is_available: true`
- `reason: "AVAILABLE"`
- `alternatives: []`（不需要替代方案）

**说明**：2025-01-11 的数学提高班有空位（2/5），可以直接预约。

---

### ✅ 场景 2：目标日期完全空（最佳情况）
**测试条件**：
```json
{
  "course_name": "数学提高班",
  "original_date": "2025-01-10",
  "target_date": "2025-01-13"
}
```
**预期结果**：
- `is_available: true`
- `reason: "AVAILABLE"`
- `alternatives: []`

**说明**：2025-01-13 的数学提高班完全空（0/5），是最佳选择。

---

### ✅ 场景 3：目标日期满员，但有替代方案
**测试条件**：
```json
{
  "course_name": "数学提高班",
  "original_date": "2025-01-10",
  "target_date": "2025-01-10"
}
```
**预期结果**：
- `is_available: false`
- `reason: "FULL"`
- `alternatives: [...]`（返回同课程其他有空位的日期，最多3个）

**说明**：2025-01-10 满员，但会返回 2025-01-11、2025-01-12、2025-01-13 等有空位的替代日期。

---

### ✅ 场景 4：英语口语班有空位
**测试条件**：
```json
{
  "course_name": "英语口语班",
  "original_date": "2025-01-11",
  "target_date": "2025-01-10"
}
```
**预期结果**：
- `is_available: true`
- `reason: "AVAILABLE"`

**说明**：2025-01-10 的英语口语班有空位（4/6）。

---

### ✅ 场景 5：目标日期有空位，但较少
**测试条件**：
```json
{
  "course_name": "数学提高班",
  "original_date": "2025-01-10",
  "target_date": "2025-01-12"
}
```
**预期结果**：
- `is_available: true`
- `reason: "AVAILABLE"`

**说明**：2025-01-12 有空位（1/4），虽然剩余不多，但仍可预约。

---

## 2. 无法约档期的场景

### ❌ 场景 1：目标日期满员，且无替代方案
**测试条件**：
```json
{
  "course_name": "物理实验班",
  "original_date": "2025-01-16",
  "target_date": "2025-01-17"
}
```
**预期结果**：
- `is_available: false`
- `reason: "FULL"`
- `alternatives: []`（如果只有这一个档期且满员）

**说明**：2025-01-17 满员（8/8），且如果只有这一个替代档期，则无替代方案。

---

### ❌ 场景 2：课程不存在
**测试条件**：
```json
{
  "course_name": "化学实验班",
  "original_date": "2025-01-10",
  "target_date": "2025-01-11"
}
```
**预期结果**：
- `is_available: false`
- `reason: "COURSE_NOT_FOUND"`
- `alternatives: []`

**说明**：系统中不存在"化学实验班"这个课程。

---

### ❌ 场景 3：目标日期没有该课程的档期
**测试条件**：
```json
{
  "course_name": "数学提高班",
  "original_date": "2025-01-10",
  "target_date": "2025-01-20"
}
```
**预期结果**：
- `is_available: false`
- `reason: "NOT_FOUND"`
- `alternatives: [...]`（返回其他有空位的日期）

**说明**：2025-01-20 没有数学提高班的档期，但会返回其他日期的替代方案。

---

### ❌ 场景 4：目标日期满员，替代方案也满员
**测试条件**：
```json
{
  "course_name": "英语口语班",
  "original_date": "2025-01-10",
  "target_date": "2025-01-11"
}
```
**预期结果**：
- `is_available: false`
- `reason: "FULL"`
- `alternatives: [...]`（返回其他有空位的日期，如 2025-01-10、2025-01-12 等）

**说明**：2025-01-11 满员（6/6），但会返回其他有空位的日期作为替代。

---

### ❌ 场景 5：所有档期都满员
**测试条件**：
```json
{
  "course_name": "数学提高班",
  "original_date": "2025-01-10",
  "target_date": "2025-01-15"
}
```
**预期结果**：
- `is_available: false`
- `reason: "FULL"`
- `alternatives: [...]`（返回其他有空位的日期，如 2025-01-11、2025-01-12、2025-01-13）

**说明**：2025-01-15 满员，但会返回其他有空位的日期作为替代。

---

## 测试命令示例

### 使用 curl 测试可约场景

```bash
# 场景 1：目标日期有空位
curl -X POST http://localhost:8000/api/query-available-slots \
  -H "Content-Type: application/json" \
  -d '{
    "course_name": "数学提高班",
    "original_date": "2025-01-10",
    "target_date": "2025-01-11"
  }'

# 场景 2：目标日期完全空
curl -X POST http://localhost:8000/api/query-available-slots \
  -H "Content-Type: application/json" \
  -d '{
    "course_name": "数学提高班",
    "original_date": "2025-01-10",
    "target_date": "2025-01-13"
  }'
```

### 使用 curl 测试不可约场景

```bash
# 场景 1：目标日期满员
curl -X POST http://localhost:8000/api/query-available-slots \
  -H "Content-Type: application/json" \
  -d '{
    "course_name": "数学提高班",
    "original_date": "2025-01-10",
    "target_date": "2025-01-10"
  }'

# 场景 2：课程不存在
curl -X POST http://localhost:8000/api/query-available-slots \
  -H "Content-Type: application/json" \
  -d '{
    "course_name": "化学实验班",
    "original_date": "2025-01-10",
    "target_date": "2025-01-11"
  }'

# 场景 3：目标日期没有档期
curl -X POST http://localhost:8000/api/query-available-slots \
  -H "Content-Type: application/json" \
  -d '{
    "course_name": "数学提高班",
    "original_date": "2025-01-10",
    "target_date": "2025-01-20"
  }'
```

---

## 快速测试清单

### ✅ 可约档期测试
- [ ] 目标日期有空位 → `is_available: true`
- [ ] 目标日期完全空 → `is_available: true`
- [ ] 目标日期满员但有替代方案 → `is_available: false`, `alternatives` 不为空

### ❌ 不可约档期测试
- [ ] 课程不存在 → `reason: "COURSE_NOT_FOUND"`
- [ ] 目标日期没有档期 → `reason: "NOT_FOUND"`
- [ ] 目标日期满员 → `reason: "FULL"`

---

## 数据状态总结

| 课程名称 | 日期 | 状态 | 容量 | 已约 | 剩余 |
|---------|------|------|------|------|------|
| 数学提高班 | 2025-01-10 | ❌ 满员 | 5 | 5 | 0 |
| 数学提高班 | 2025-01-11 | ✅ 有空位 | 5 | 2 | 3 |
| 数学提高班 | 2025-01-12 | ✅ 有空位 | 4 | 1 | 3 |
| 数学提高班 | 2025-01-13 | ✅ 完全空 | 5 | 0 | 5 |
| 数学提高班 | 2025-01-14 | ✅ 有空位 | 5 | 3 | 2 |
| 数学提高班 | 2025-01-15 | ❌ 满员 | 5 | 5 | 0 |
| 英语口语班 | 2025-01-10 | ✅ 有空位 | 6 | 4 | 2 |
| 英语口语班 | 2025-01-11 | ❌ 满员 | 6 | 6 | 0 |
| 英语口语班 | 2025-01-12 | ✅ 有空位 | 6 | 2 | 4 |
| 英语口语班 | 2025-01-13 | ❌ 满员 | 6 | 6 | 0 |
| 英语口语班 | 2025-01-14 | ✅ 有空位 | 6 | 3 | 3 |
| 英语口语班 | 2025-01-15 | ✅ 有空位 | 6 | 1 | 5 |
| 物理实验班 | 2025-01-16 | ✅ 有空位 | 8 | 2 | 6 |
| 物理实验班 | 2025-01-17 | ❌ 满员 | 8 | 8 | 0 |

